
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trading777 Self‑Check</title>
<script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
<style>
body{font-family:Arial,Helvetica,sans-serif;margin:2rem;}
.pass{color:green;font-weight:bold;}
.fail{color:red;font-weight:bold;}
</style>
</head>
<body>
<h1>Trading777 Data File Integrity Check</h1>
<div id="results"></div>
<script>
const { DateTime } = luxon;

function checkDates(obj){
  const isoRegex = /^\d{4}-\d{2}-\d{2}$/;
  return Object.keys(obj).every(k=>isoRegex.test(k));
}

async function run(){
  const files = ['data/close_prices.json','data/dailyClose.json'];
  const resultsDiv = document.getElementById('results');
  for(const file of files){
    const container=document.createElement('section');
    container.innerHTML=`<h3>${file}</h3>`;
    try{
      const res=await fetch(file);
      if(!res.ok) throw new Error('HTTP '+res.status);
      const data=await res.json();
      const hasDates = Array.isArray(data)? false : checkDates(data);
      const dateFormatOk = hasDates ? '✅ Keys are YYYY‑MM‑DD' : (Array.isArray(data)? 'ℹ️ Array: no date keys to validate' : '❌ Invalid date keys');
      container.innerHTML += `<p class="${hasDates||Array.isArray(data)?'pass':'fail'}">${dateFormatOk}</p>`;
    }catch(e){
      container.innerHTML+=`<p class="fail">❌ File missing or unreadable: ${e.message}</p>`;
    }
    resultsDiv.appendChild(container);
  }
}
run();
</script>
</body>
</html>
