
Trading777 v7.15 更新日志
=========================

日期: 2025-07-06

【核心修复】
1. **资金收益曲线不显示 / 页面空白**
   - 修复 `analysisPage.js` 中 `let curMode='day';='day';` 语法错误与重复按钮监听段落导致的 JS 报错。
   - 重写按钮交互，确保“日 / 周 / 月”切换正常工作。

2. **历史价格缺失**
   - `fetchDailyCloses()` 现在先尝试 **Finnhub**，若返回 `s !== 'ok'` 自动回退到 **Alpha Vantage** (`TIME_SERIES_DAILY_ADJUSTED`)。
   - 新增 Alpha Key 解析，支持在 `KEY.txt` 中读取 `Alpha key：xxxx`。
   - 计算模块 6（当日浮动盈亏）可在缺失 Finnhub 数据时继续正常工作。

3. **代码健壮性**
   - 替换旧版 `getApiKeys()`，统一返回 `{finnhub, alpha}`。
   - 优化历史数据按日期切片函数，避免冗余内存占用。
   - 去除残留的无效省略号字符与重复代码块。

【视觉 / 版本】
- 将所有页面底部版本标签更新为 **v7.15**。

测试清单
--------
- [x] 首页、仪表盘、交易分析均可正常加载，无控制台报错
- [x] 自动拉取 2024-01-01 ~ 当前日期持仓历史，曲线绘制成功
- [x] Alpha Vantage Fallback 在断网 Finnhub Token 时通过
- [x] “日 / 周 / 月” 切换按钮 UI 状态同步

—— End of Log —— 
